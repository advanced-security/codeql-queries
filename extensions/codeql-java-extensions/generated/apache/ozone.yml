extensions:
  - addsTo:
      pack: codeql/java-queries
      extensible: sinkModel
    data:
      - ["csi.v1", "NodeGrpc$NodeImplBase", true, "nodePublishVolume", "(NodePublishVolumeRequest,StreamObserver)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.fs", "SpaceUsagePersistence", true, "save", "(SpaceUsageSource)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.scm.cli", "ScmSubcommand", true, "execute", "(ScmClient)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.scm.ha", "InterSCMGrpcClient$StreamDownloader", true, "StreamDownloader", "(CompletableFuture,Path)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.scm.ha", "SCMHAManager", true, "downloadCheckpointFromLeader", "(String)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.scm.ha", "SCMSnapshotDownloader", true, "download", "(Path)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.scm.ha", "SCMSnapshotProvider", true, "getSCMDBSnapshot", "(String)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.scm.ha", "SCMSnapshotProvider", true, "getSCMDBSnapshot", "(String)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.scm.net", "NodeSchemaLoader", false, "loadSchemaFromFile", "(String)", "", "Argument[0]", "read-file", "generated"]
      - ["org.apache.hadoop.hdds.scm.server", "SCMStorageConfig", true, "SCMStorageConfig", "(NodeType,File,String)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.scm.server", "SCMStorageConfig", true, "SCMStorageConfig", "(NodeType,File,String)", "", "Argument[2]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.authority", "CertificateServer", true, "getCACertificate", "()", "", "Argument[-1]", "read-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.authority", "CertificateServer", true, "getCaCertPath", "()", "", "Argument[-1]", "read-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.authority", "CertificateServer", true, "requestCertificate", "(PKCS10CertificationRequest,ApprovalType,NodeType)", "", "Argument[-1]", "read-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.client", "CertificateClient", true, "storeCertificate", "(String,CAType)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.client", "CommonCertificateClient", true, "CommonCertificateClient", "(SecurityConfig,Logger,String,String,Consumer,Runnable)", "", "Argument[3]", "read-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.client", "DefaultCertificateClient", true, "renewAndStoreKeyAndCertificate", "(boolean)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.client", "DefaultCertificateClient", true, "signAndStoreCertificate", "(PKCS10CertificationRequest,Path)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.client", "SCMCertificateClient", true, "SCMCertificateClient", "(SecurityConfig,String,String)", "", "Argument[2]", "read-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.utils", "CertificateCodec", true, "getCertPath", "(String)", "", "Argument[-1]", "read-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.utils", "CertificateCodec", true, "getCertPath", "(String)", "", "Argument[0]", "read-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.utils", "CertificateCodec", true, "getTargetCertHolder", "()", "", "Argument[-1]", "read-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.utils", "CertificateCodec", true, "getTargetCertHolder", "(Path,String)", "", "Argument[0]", "read-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.utils", "CertificateCodec", true, "getTargetCertHolder", "(Path,String)", "", "Argument[1]", "read-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.utils", "CertificateCodec", true, "writeCertificate", "(Path,String,String)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.utils", "CertificateCodec", true, "writeCertificate", "(Path,String,String)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.utils", "CertificateCodec", true, "writeCertificate", "(String,String)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.utils", "CertificateCodec", true, "writeCertificate", "(String,String)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.utils", "CertificateCodec", true, "writeCertificate", "(X509CertificateHolder)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.utils", "CertificateCodec", true, "writeCertificate", "(X509CertificateHolder,String)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.certificate.utils", "CertificateCodec", true, "writeCertificate", "(X509CertificateHolder,String)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.crl", "CRLCodec", true, "writeCRL", "(Path,String,String,boolean)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.crl", "CRLCodec", true, "writeCRL", "(Path,String,String,boolean)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.crl", "CRLCodec", true, "writeCRL", "(X509CRL)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.crl", "CRLCodec", true, "writeCRL", "(X509CRLHolder,String,boolean)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.crl", "CRLCodec", true, "writeCRL", "(X509CRLHolder,String,boolean)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.keys", "KeyCodec", true, "writeKey", "(KeyPair)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.keys", "KeyCodec", true, "writeKey", "(KeyPair,boolean)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.keys", "KeyCodec", true, "writeKey", "(Path,KeyPair,boolean)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.keys", "KeyCodec", true, "writePrivateKey", "(PrivateKey)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.security.x509.keys", "KeyCodec", true, "writePublicKey", "(PublicKey)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.utils", "HAUtils", false, "replaceDBWithCheckpoint", "(long,File,Path,String)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.utils", "HAUtils", false, "replaceDBWithCheckpoint", "(long,File,Path,String)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.utils", "HAUtils", false, "replaceDBWithCheckpoint", "(long,File,Path,String)", "", "Argument[3]", "create-file", "generated"]
      - ["org.apache.hadoop.hdds.utils", "HddsServerUtil", false, "includeFile", "(File,String,ArchiveOutputStream)", "", "Argument[0]", "read-file", "generated"]
      - ["org.apache.hadoop.ozone.audit.parser.common", "DatabaseHelper", false, "executeCustomQuery", "(String,String)", "", "Argument[0]", "jdbc-url", "generated"]
      - ["org.apache.hadoop.ozone.audit.parser.common", "DatabaseHelper", false, "executeCustomQuery", "(String,String)", "", "Argument[1]", "sql", "generated"]
      - ["org.apache.hadoop.ozone.audit.parser.common", "DatabaseHelper", false, "executeTemplate", "(String,String)", "", "Argument[0]", "jdbc-url", "generated"]
      - ["org.apache.hadoop.ozone.audit.parser.common", "DatabaseHelper", false, "setup", "(String,String)", "", "Argument[0]", "jdbc-url", "generated"]
      - ["org.apache.hadoop.ozone.common", "Storage", true, "Storage", "(NodeType,File,String,String,int)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.common", "Storage", true, "Storage", "(NodeType,File,String,String,int)", "", "Argument[2]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.common", "Storage", true, "Storage", "(NodeType,File,String,int)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.common", "Storage", true, "Storage", "(NodeType,File,String,int)", "", "Argument[2]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.common", "StorageInfo", true, "StorageInfo", "(NodeType,File)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.common", "StorageInfo", true, "writeTo", "(File)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.container.common.helpers", "ContainerUtils", false, "readDatanodeDetailsFrom", "(File)", "", "Argument[0]", "read-file", "generated"]
      - ["org.apache.hadoop.ozone.container.common.helpers", "ContainerUtils", false, "writeDatanodeDetailsTo", "(DatanodeDetails,File,ConfigurationSource)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.container.common.helpers", "DatanodeIdYaml", false, "createDatanodeIdFile", "(DatanodeDetails,File,ConfigurationSource)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.container.common.helpers", "DatanodeIdYaml", false, "readDatanodeIdFile", "(File)", "", "Argument[0]", "read-file", "generated"]
      - ["org.apache.hadoop.ozone.container.common.helpers", "DatanodeVersionFile", true, "createVersionFile", "(File)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.container.common.helpers", "DatanodeVersionFile", true, "readFrom", "(File)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.container.common.impl", "ContainerDataYaml", false, "createContainerFile", "(ContainerType,ContainerData,File)", "", "Argument[2]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.container.common.impl", "ContainerDataYaml", false, "readContainerFile", "(File)", "", "Argument[0]", "read-file", "generated"]
      - ["org.apache.hadoop.ozone.container.common.transport.server.ratis", "ContainerStateMachine", true, "buildMissingContainerSet", "(File)", "", "Argument[0]", "read-file", "generated"]
      - ["org.apache.hadoop.ozone.container.common.utils", "StorageVolumeUtil", false, "checkVolume", "(StorageVolume,String,String,ConfigurationSource,Logger,MutableVolumeSet)", "", "Argument[2]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.container.common.volume", "HddsVolume", true, "createDeleteServiceDir", "()", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.container.keyvalue.interfaces", "ChunkManager", true, "getStreamDataChannel", "(Container,BlockID,ContainerMetrics)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.container.replication", "ContainerDownloader", true, "getContainerDataFromReplicas", "(long,List,Path,CopyContainerCompression)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.container.replication", "ContainerDownloader", true, "getContainerDataFromReplicas", "(long,List,Path,CopyContainerCompression)", "", "Argument[2]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.container.replication", "ContainerImporter", true, "importContainer", "(long,Path,HddsVolume,CopyContainerCompression)", "", "Argument[1]", "read-file", "generated"]
      - ["org.apache.hadoop.ozone.container.replication", "GrpcReplicationClient$StreamDownloader", true, "StreamDownloader", "(long,CompletableFuture,Path)", "", "Argument[2]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.container.replication", "GrpcReplicationClient", true, "download", "(long,Path)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.container.replication", "GrpcReplicationClient", true, "download", "(long,Path)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.container.stream", "DirstreamClientHandler", true, "doRead", "(ChannelHandlerContext,ByteBuf)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.container.upgrade", "ScmHAFinalizeUpgradeActionDatanode", true, "upgradeVolume", "(StorageVolume,String)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.container.upgrade", "VersionedDatanodeFeatures$ScmHA", true, "upgradeVolumeIfNeeded", "(StorageVolume,String)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.om.multitenant", "MultiTenantAccessController", true, "createPolicy", "(Policy)", "", "Argument[-1]", "open-url", "generated"]
      - ["org.apache.hadoop.ozone.om.multitenant", "MultiTenantAccessController", true, "createRole", "(Role)", "", "Argument[-1]", "open-url", "generated"]
      - ["org.apache.hadoop.ozone.om.multitenant", "MultiTenantAccessController", true, "deletePolicy", "(String)", "", "Argument[0]", "open-url", "generated"]
      - ["org.apache.hadoop.ozone.om.multitenant", "MultiTenantAccessController", true, "deleteRole", "(String)", "", "Argument[0]", "open-url", "generated"]
      - ["org.apache.hadoop.ozone.om.multitenant", "MultiTenantAccessController", true, "getPolicy", "(String)", "", "Argument[0]", "open-url", "generated"]
      - ["org.apache.hadoop.ozone.om.multitenant", "MultiTenantAccessController", true, "getRole", "(String)", "", "Argument[0]", "open-url", "generated"]
      - ["org.apache.hadoop.ozone.om.multitenant", "MultiTenantAccessController", true, "updateRole", "(long,Role)", "", "Argument[-1]", "open-url", "generated"]
      - ["org.apache.hadoop.ozone.om.multitenant", "MultiTenantAccessController", true, "updateRole", "(long,Role)", "", "Argument[0]", "open-url", "generated"]
      - ["org.apache.hadoop.ozone.om.multitenant", "RangerRestMultiTenantAccessController", true, "getPolicies", "()", "", "Argument[-1]", "open-url", "generated"]
      - ["org.apache.hadoop.ozone.om.multitenant", "RangerRestMultiTenantAccessController", true, "getRoles", "()", "", "Argument[-1]", "open-url", "generated"]
      - ["org.apache.hadoop.ozone.om.multitenant", "RangerRestMultiTenantAccessController", true, "updatePolicy", "(long,Policy)", "", "Argument[-1]", "open-url", "generated"]
      - ["org.apache.hadoop.ozone.om.multitenant", "RangerRestMultiTenantAccessController", true, "updatePolicy", "(long,Policy)", "", "Argument[0]", "open-url", "generated"]
      - ["org.apache.hadoop.ozone.om.snapshot", "OmSnapshotUtils", false, "createHardLinks", "(Path)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.recon.spi", "StorageContainerServiceProvider", true, "getSCMDBSnapshot", "()", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.recon.spi", "StorageContainerServiceProvider", true, "getSCMDBSnapshot", "()", "", "Argument[-1]", "read-file", "generated"]
      - ["org.apache.hadoop.ozone.recon", "ReconUtils", true, "createTarFile", "(Path)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.recon", "ReconUtils", true, "untarCheckpointFile", "(File,Path)", "", "Argument[0]", "read-file", "generated"]
      - ["org.apache.hadoop.ozone.recon", "ReconUtils", true, "untarCheckpointFile", "(File,Path)", "", "Argument[1]", "create-file", "generated"]
      - ["org.apache.hadoop.ozone.shell.token", "TokenOption", true, "decode", "()", "", "Argument[-1]", "read-file", "generated"]
      - ["org.apache.hadoop.ozone.shell.token", "TokenOption", true, "persistToken", "(Token)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.apache.ozone.fs.http.server", "HttpFSServer", true, "post", "(InputStream,UriInfo,String,OperationParam,Parameters,HttpServletRequest)", "", "Argument[1]", "url-redirect", "generated"]
      - ["org.apache.ozone.fs.http.server", "HttpFSServer", true, "postRoot", "(InputStream,UriInfo,OperationParam,Parameters,HttpServletRequest)", "", "Argument[1]", "url-redirect", "generated"]
      - ["org.apache.ozone.fs.http.server", "HttpFSServer", true, "put", "(InputStream,UriInfo,String,OperationParam,Parameters,HttpServletRequest)", "", "Argument[1]", "url-redirect", "generated"]
      - ["org.apache.ozone.fs.http.server", "HttpFSServer", true, "putRoot", "(InputStream,UriInfo,OperationParam,Parameters,HttpServletRequest)", "", "Argument[1]", "url-redirect", "generated"]
      - ["org.apache.ozone.rocksdiff", "RocksDBCheckpointDiffer", true, "RocksDBCheckpointDiffer", "(String,String,String,String,long,long)", "", "Argument[0]", "create-file", "generated"]
      - ["org.apache.ozone.rocksdiff", "RocksDBCheckpointDiffer", true, "RocksDBCheckpointDiffer", "(String,String,String,String,long,long)", "", "Argument[2]", "create-file", "generated"]
      - ["org.apache.ozone.rocksdiff", "RocksDBCheckpointDiffer", true, "setCurrentCompactionLog", "(long)", "", "Argument[-1]", "create-file", "generated"]
      - ["org.hadoop.ozone.recon.codegen", "SqlDbUtils", false, "createNewDerbyDatabase", "(String,String)", "", "Argument[0]", "jdbc-url", "generated"]
      - ["org.hadoop.ozone.recon.codegen", "SqlDbUtils", false, "createNewDerbyDatabase", "(String,String)", "", "Argument[1]", "jdbc-url", "generated"]

  - addsTo:
      pack: codeql/java-queries
      extensible: sourceModel
    data:
      - ["org.apache.hadoop.ozone.admin.nssummary", "NSSummaryCLIUtils", false, "makeHttpCall", "(StringBuffer,String,boolean,ConfigurationSource)", "", "ReturnValue", "remote", "generated"]
      - ["org.apache.hadoop.ozone.admin.nssummary", "NSSummaryCLIUtils", false, "makeHttpCall", "(StringBuffer,String,boolean,boolean,boolean,ConfigurationSource)", "", "ReturnValue", "remote", "generated"]
      - ["org.apache.hadoop.ozone.s3.util", "AuditUtils", false, "getAuditParameters", "(ContainerRequestContext)", "", "ReturnValue", "remote", "generated"]
      - ["org.apache.hadoop.ozone.s3.util", "AuditUtils", false, "getClientIpAddress", "(ContainerRequestContext)", "", "ReturnValue", "remote", "generated"]

